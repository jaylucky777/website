---
title: "SQL"
output: html_document
---
```{r warning=FALSE,message=FALSE}
library(Lahman)
library(sqldf)
```
---
title: "SQL"
output: html_document
---

## Filtering Rows and Columns

In SQL you can filter columns by using SELECT and rows by using WHERE.  Let's look at an example using the Lahman baseball database.  First, we should load the Lahman package.  We will also need the sqldf package.

```{r message=FALSE, warning=FALSE}
library(Lahman)
library(sqldf)
```

Let's take a look at an example.  Suppose we want to see the home run totals for the 1927 Yankees.  We could write:

```{r message=FALSE, warning=FALSE}
query<-"SELECT playerID,teamID,yearID,HR FROM Batting WHERE teamID='NYA' and yearID=1927"
sqldf(query)
```
#------------------------------------------
###NY Yankees with 40 or more Homeruns
Moving on we can query out which NY Yankees players hit 40 or more homeruns with the following code:

```{r message=FALSE, warning=FALSE}
query<-"SELECT playerID,yearID,teamID,HR FROM Batting WHERE teamID='NYA' and HR>=40"
sqldf(query)
```
#------------------------------------------
###Strike Outs and Homeruns
Adding the Strike Outs into the query we can further filter out which players hit over 40 homeruns AND had less than 60 strike outs with the following:

```{r message=FALSE, warning=FALSE}
query<-"SELECT playerID,teamID,yearID,HR,SO FROM Batting WHERE HR>40 and SO<60"
sqldf(query)
```
#------------------------------------------
###Team Filter
Finally we're filtering all the teams to just the Phillies, query the years in the 1970's (using a range), and finally extract the players with more than 30 homeruns.

```{r message=FALSE, warning=FALSE}
query<-"SELECT playerID,teamID,yearID,HR FROM Batting WHERE teamID='PHI' and yearID>=1970 and yearID<=1979 and HR>30"
sqldf(query)
```
#------------------------------------------
### ORDER BY

This filter extracts every instance of a player hitting more than 50 homeruns.  Furthermore, let's have the players with the highest homerun total at the top.

```{r message=FALSE, warning=FALSE}
query<-"SELECT playerID,yearID,teamID,HR FROM Batting 
WHERE HR>50 
ORDER BY HR DESC"
sqldf(query)
```
